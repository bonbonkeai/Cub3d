NAME		=	cub3D

# Diectories and libraries
LIBFT		=	Libft/libft.a
INC			=	includes/
SRC_DIR		=	srcs/
OBJ_DIR		=	obj/
MLX_DIR		=	mlx_linux/
MLX_LIB		=	$(MLX_DIR)libmlx.a

# Compiler and CFlags
CC			=	cc
CFLAGS		=	-Wall -Wextra -Werror
INCLUDES	=	-Iincludes -I/usr/include -Imlx -I./libft
INCLUDES_B	=	-Ibonus/includes -I/usr/include -Imlx -I./libft
FLAGS		=	-Lmlx_linux -lmlx -L/usr/lib/X11 -lXext -lX11 -lm
RM			=	rm -f

# source files
SRCS	= srcs/init/init_game.c \
		srcs/init/init_img.c \
		srcs/init/init_keys.c \
		srcs/init/init_mlx.c \
		srcs/init/init_ray.c \
		srcs/init/init_texture.c \
		srcs/main/cub3d.c \
		srcs/parser/check_init_map.c \
		srcs/parser/check_init_player.c \
		srcs/parser/handle_line1.c \
		srcs/parser/check_map.c \
		srcs/parser/parser_color.c \
		srcs/parser/parser_tex.c \
		srcs/parser/parser_split.c \
		srcs/parser/parser_utils.c \
		srcs/parser/parser.c \
		srcs/raycasting/raycasting.c \
		srcs/raycasting/utils.c \
		srcs/setup/control.c \
		srcs/setup/hook.c \
		srcs/setup/key.c \
		srcs/setup/minimap.c \
		srcs/setup/mouse.c

OBJS		=	$(patsubst $(SRC_DIR)%.c,$(OBJ_DIR)%.o,$(SRCS))

# Build rules
all:		$(NAME)

$(LIBFT):
		@make -sC ./libft
		@echo "Libft compilation success!"

$(MLX_LIB):
		@make -sC $(MLX_DIR)

$(NAME):	$(OBJS) $(LIBFT) $(MLX_LIB)
		@$(CC) $(CFLAGS) $(OBJS) $(FLAGS) $(INCLUDES) \
		$(LIBFT) $(MLX_LIB) -o $(NAME)
		@echo "Compilation success!"

$(OBJ_DIR)%.o:	$(SRC_DIR)%.c
		@mkdir -p $(@D)
		@$(CC) $(CFLAGS) -Iinclude -Imlx -c $< -o $@

clean:
		@$(RM) -r $(OBJ_DIR) $(OBJ_DIR_B)
		@make clean -C ./libft
		@make clean -C $(MLX_DIR)

fclean:		clean
		@$(RM) $(NAME)
		@$(RM) $(BONUS)
		@$(RM) $(LIBFT)
		@make clean -C $(MLX_DIR)

re:		fclean all

# Phony targets represent actions instead of files
.PHONY:		all clean fclean re bonus